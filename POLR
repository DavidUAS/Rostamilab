############### Specifying dataset
data <- readRDS("Uppsala.data.RDS")

################ Formatting data

data$TrainingSet$eGOS <- as.ordered(data$TrainingSet$eGOS)

data$TrainingSet$age <- as.numeric(data$TrainingSet$age)
data$TrainingSet$motor <- as.numeric(data$TrainingSet$motor)
data$TrainingSet$pupil <- as.numeric(data$TrainingSet$pupil)
data$TrainingSet$CT <- as.numeric(data$TrainingSet$CT)

data$TestSet$eGOS <- as.ordered(data$TestSet$eGOS)

data$TestSet$age <- as.numeric(data$TestSet$age)
data$TestSet$motor <- as.numeric(data$TestSet$motor)
data$TestSet$pupil <- as.numeric(data$TestSet$pupil)
data$TestSet$CT <- as.numeric(data$TestSet$CT)

str(data)

################ Setting up the model
library(MASS)

set.seed(0)

model <- polr(eGOS ~  age + motor + pupil + CT, data = data$TrainingSet, Hess = TRUE)

summary(model)

saveRDS(model, file="POLR.RDS")

