############### Specifying dataset
data <- readRDS("Uppsala.data.RDS")

train.data <- data$TrainingSet
test.data <- data$TestSet

################ Formatting data

train.data$eGOS <- as.factor(train.data$eGOS)
train.data$age <- as.numeric(train.data$age)
train.data$pupil <- as.factor(train.data$pupil)
train.data$motor <- as.factor(train.data$motor)
train.data$CT <- as.factor(train.data$CT)

train.data$eGOS <- as.factor(data$TrainingSet$eGOS)


test.data$eGOS <- as.factor(test.data$eGOS)
test.data$age <- as.numeric(test.data$age)
test.data$pupil <- as.factor(test.data$pupil)
test.data$motor <- as.factor(test.data$motor)
test.data$CT <- as.factor(test.data$CT)

test.data$eGOS <- as.factor(data$TestSet$eGOS)

str(data)

################ Setting up the model
library(MASS)

set.seed(0)

model <- polr(eGOS ~  age + motor + pupil + CT, data = train.data, Hess = TRUE)

summary(model)

saveRDS(model, file="POLR.RDS")

